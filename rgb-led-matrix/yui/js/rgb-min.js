function init(){rgb_led_matrix_init()}function rgb_led_matrix_init(){var x=false,D=null,c=8,y=1,G=1,t=false,A=new Uint8Array(c*y*3),m=document.getElementById("matrix"),K=m.getContext("2d"),C=window.innerWidth,o=window.innerHeight,s=C/(c+1),J=o/(y+1),B=s*0.4,g=0,e=0,H=null,b=null,n=null,d=null,t=false,q=["cpu_meter","aurora","timesquare","fireplace","notifier","cpu_meter","ambilight"],h=["s3d.jpg","twitter.jpg","vrip.jpg"];function z(M,O,N){x&&console.log("WEBSOCKET: CONNECT");try{n=O;d=N;socket=new WebSocket(M);socket.binaryType="arraybuffer";socket.onopen=F;socket.onclose=r;socket.onerror=l;socket.onmessage=function(Q){w(Q)}}catch(P){x&&console.log("WEBSOCKET: CONNECT ERROR");x&&console.log(P.message)}}function F(){x&&console.log("WEBSOCKET: OPEN");socket=this;n()}function w(M){A=new Uint8Array(M.data);x&&console.log("WEBSOCKET: ONMESSAGE: "+M.data);p()}function r(M){x&&console.log("WEBSOCKET: ONCLOSE");D=null;d()}function l(M){x&&console.log("WEBSOCKET: ONERROR");x&&console.log(M.message)}function v(O,N){x&&console.log("WEBSOCKET: SEND");var M={method:O,params:N};if(socket.readyState===socket.OPEN){socket.send(I(JSON.stringify(M)))}}function I(Q){var N=new ArrayBuffer(Q.length);var M=new Uint8Array(N);for(var O=0,P=Q.length;O<P;O++){M[O]=Q.charCodeAt(O)}return N}function E(){x&&console.log("UI INIT");z("ws://localhost:8080",t,k)}function t(){x&&console.log("UI CONNECTED");t=true;resize()}function k(){x&&console.log("UI DISCONNECTED");t=false}function L(){var M=Math.floor(Math.random()*8+1);var N=Math.floor(Math.random()*8+1);v("resize",[M,N]);var O=Math.floor(Math.random()*q.length());var P=Math.floor(Math.random()*h.length());v("switch_shader",[O,P]);c=M;y=N;a();setTimeout(L,5000)}E();function a(){x&&console.log("resizeMatrix");C=window.innerWidth;o=window.innerHeight;g=0;e=0;m.width=C;m.height=o;m.style.width=C;m.style.height=o;s=C/(c+1);J=o/(y+1);if(s>J){s=J}else{J=s}e=(o-J*(y+1))/2;g=(C-s*(c+1))/2;B=s*0.4}function p(){x&&console.log("drawMatrix");for(i=0;i<y;i++){for(j=0;j<c;j++){var M=s*(j+1),N=J*(i+1);f(M,N,B,u(i,j))}}}function u(Q,N){var P=A[(Q*c+N)*3+0],O=A[(Q*c+N)*3+1],M=A[(Q*c+N)*3+2];x&&console.log("getColor:"+N+" "+Q+" "+(Q*y+N));return"rgba("+P+","+O+","+M+",1)"}function f(N,P,M,O){K.beginPath();K.arc(N+g,P+e,M,0,2*Math.PI,false);K.fillStyle=O;K.fill();K.lineWidth=1;K.strokeStyle="#101010";K.stroke();x&&console.log("drawDot: "+O)}a();document.getElementsByTagName("BODY")[0].onresize=a};