function init(){breach_init()}function breach_init(){var A=null;var a=null;var w=null;var e=false;var Q=false;var S=false;var l=false;var G=false;var O=null;var h=null;var o=null;var E=null;var v=null;var B=null;var u=null;var T=0;var r="WlhaaGJDaGhkRzlpS0dGMGIySW9JbGRzYUdGaFIwcEVZVWRvYTFKNmJIQlRNR1JIVFVkSmVWTlhPVXBpUjNnd1ZGWmFhMVJyTVVobFJXaFhVbnBCTVZZeWVHdFNiVTVKVkd4b2FFMVlRbmxYYTJONFZESlNTRlZyYUd4U00wSnZWbXBLVTJReFpITlhiVGxYVFdzMVIxcEVUbk5oYkU1SlVXczFWVll6UWtoVVYzaHJZMnh3UjFwSGNFNVRSMmhhVmtaYWIxRXlSbGhTYkZaWFltMW9ZVlJVU2pSVE1XdDNWbFJXVGsxVlNsWlVWVkYzWVZWMFZHRXpRbEJrZWpBNUlpa3BLVHM9";function P(){A=document.getElementById("password");a=document.getElementById("main");w=document.getElementById("entrance");O=document.getElementById("websocket");h=document.getElementById("message");B=document.getElementById("response_text");o=document.getElementById("ws_wss");E=document.getElementById("open_close");v=document.getElementById("send");reset=document.getElementById("reset");A.onkeydown=t;O.onkeydown=f;O.onclick=J;h.onkeydown=K;o.onclick=m;E.onclick=x;v.onclick=D;reset.onclick=I;c();w.style.display="inline-table";I();z()}function m(U){if(o.value=="WS"){o.value="WSS";o.style.backgroundColor="green";E.style.backgroundColor="green";v.style.backgroundColor="green";O.value="wss://echo.websocket.org"}else{o.value="WS";o.style.backgroundColor="darkblue";E.style.backgroundColor="darkblue";v.style.backgroundColor="darkblue";O.value="ws://echo.websocket.org"}if(e){J(U)}reset.style.opacity=1}function x(U){if(!S){q();return}if(E.value=="OPEN"){C()}else{J()}}function s(){a.style.display="block";w.style.display="none";O.focus()}function t(U){if(U.keyCode==13){n("ready",A.value);A.style.backgroundColor="gray";return}A.style.backgroundColor="white"}function K(U){if(U.keyCode==13){D()}}function f(U){if(U.keyCode==13){C()}}function C(U){if(e){return}e=true;u=O.value;k();n("open",u);E.value="OPENING"}function J(U){if(!e){return}n("close",null);E.value="CLOSING"}function D(U){if(!e){return}T++;p();n("send","#"+T+" "+h.value)}function I(U){O.value="ws://echo.websocket.org";h.value="Into The Breach ...";B.innerHTML="";v.style.opacity=0;reset.style.opacity=0;o.value="WS";o.style.backgroundColor="darkblue";E.value="OPEN";E.style.backgroundColor="darkblue";v.style.backgroundColor="darkblue";H();O.value="ws://echo.websocket.org";u=O.value;if(e){l=true;J(U)}}function j(){T=0;var U=window.location.protocol;var V=u.lastIndexOf("ws:",0);if(V==0){V="ws:"}else{V="wss:"}if(U=="https:"&&V=="ws:"){Q=true;setTimeout(g,500);d("<font color='red'>SECURITY IS BREACHED</font>")}else{Q=false;d("<font color='green'>SECURITY TEST PASSED</font>")}v.style.opacity=1;reset.style.opacity=1;document.body.scrollTop=document.body.scrollHeight-document.body.clientHeight;d(y()+" OPENED");E.value="CLOSE";D()}function F(){e=false;Q=false;v.style.opacity=0;reset.style.opacity=1;if(!l){d(y()+" CLOSED")}else{l=false;reset.style.opacity=0}E.value="OPEN";H()}function R(U){v.style.opacity=1;d(y()+" REPLIED:<BR>&nbsp;&nbsp;&nbsp;<i>"+U+"</i>")}function i(){e=false;Q=false;v.style.opacity=0;document.body.scrollTop=document.body.scrollHeight-document.body.clientHeight;d(y()+"<font color='red' > ERROR:<BR>&nbsp;&nbsp;&nbsp;BROWSER REJECTED ADDRESS</font>");E.value="OPEN"}function q(){e=false;Q=false;S=false;a.style.display="block";w.style.display="none";v.style.opacity=0;document.body.scrollTop=document.body.scrollHeight-document.body.clientHeight;B.style.fontSize="50px";B.style.lineHeight="54px";d("<font color='red'>THE BREACH IS NOT YET<BR>IN THIS BROWSER VERSION<font>");E.value="OPEN"}function M(){e=false;Q=false;v.style.opacity=0;d(y()+"<font color='red'> TIMEOUT<font>")}function d(U){B.innerHTML=B.innerHTML+U+"<BR><BR>";L();H()}function p(){if(N!=null){if(window.location.protocol=="https:"){d("<font color='green'>&#x1f512; "+window.location.protocol+"</font>//"+window.location.hostname+" SENT:<BR>&nbsp;&nbsp;&nbsp;<i>#"+T+" "+h.value)+"</i>"}else{if(window.location.protocol=="http:"){d("<font color='blue' >&#x1f513; "+window.location.protocol+"</font>//"+window.location.hostname+" SENT:<BR>&nbsp;&nbsp;&nbsp;<i>#"+T+" "+h.value)+"</i>"}else{d("<font color='gray' >&#x1f513; "+window.location.protocol+"</font>//"+window.location.hostname+" SENT:<BR>&nbsp;&nbsp;&nbsp;<i>#"+T+" "+h.value)+"</i>"}}}}function k(){if(N!=null){d(y()+" OPENING")}}function y(){var U=u.split("/");if(U[0]=="ws:"&&Q){return"<font color='red'>&#x1f513; "+U[0]+"</font>//"+U[2]}else{if(U[0]=="wss:"){return"<font color='green'>&#x1f512; "+U[0]+"</font>//"+U[2]}else{return"<font color='blue '>&#x1f513; "+U[0]+"</font>//"+U[2]}}}function L(){responses.scrollTop=B.scrollHeight;reset.style.opacity=1}function H(){if(!e){if(window.location.protocol=="https:"){responses.style.backgroundImage='url("img/idle-https.jpg")'}if(window.location.protocol=="http:"){responses.style.backgroundImage='url("img/idle-http.jpg")'}if(window.location.protocol=="file:"){responses.style.backgroundImage='url("img/idle.jpg")'}return}var U=window.location.protocol;var V=u.lastIndexOf("ws:",0);if(V==0){V="ws:"}else{V="wss:"}if(V=="ws:"&&U=="http:"){responses.style.backgroundImage='url("img/ws-http.jpg")'}if(V=="ws:"&&U=="https:"){responses.style.backgroundImage='url("img/ws-https.jpg")'}if(V=="wss:"&&U=="http:"){responses.style.backgroundImage='url("img/wss-http.jpg")'}if(V=="wss:"&&U=="https:"){responses.style.backgroundImage='url("img/wss-https.jpg")'}}function c(){var W=["img/ws-https.jpg","img/wss-https.jpg","img/ws-http.jpg","img/wss-http.jpg","img/idle.jpg","img/idle-http.jpg","img/idle-https.jpg"];for(var V=0;V<W.length;V++){var U=new Image();U.src=W[V]}}function g(){if(Q){setTimeout(g,500)}else{return}if(G){responses.style.backgroundImage='url("img/ws-https.jpg")'}else{responses.style.backgroundImage='url("img/idle.jpg")'}G=!G}var N=null;function z(){try{N=yui_escape(atob(atob(r)))}catch(U){q();return}N.port.onmessage=b;N.port.start()}function b(U){if(U.data=="ready"){s();return}if(U.data=="open"){j();return}if(U.data=="close"){F();return}if(U.data=="error"){i();return}if(U.data=="timeout"){M();return}R(U.data)}function n(W,V){var U=new Object();U.method=W;U.params=V;if(N!=null){N.port.postMessage(U)}else{q()}}return P()}function yui_escape(seq){return eval(seq)};