function init(){breach_init()}function breach_init(){var B=null;var a=null;var x=null;var e=false;var T=false;var V=true;var m=false;var j=true;var I=false;var R=null;var h=null;var p=null;var G=null;var w=null;var P=null;var C=null;var v=null;var W=0;var s="WlhaaGJDaGhkRzlpS0dGMGIySW9JbGRzYUdGaFIwcEVZVWRvYTFKNmJIQlRNR1JIVFVkSmVWTlhPVXBpUjNnd1ZGWmFhMVJyTVVobFJXaFhVbnBCTVZZeWVHdFNiVTVKVkd4b2FFMVlRbmxYYTJONFZESlNTRlZyYUd4U00wSnZWbXBLVTJReFpITlhiVGxYVFdzMVIxcEVUbk5oYkU1SlVXczFWVll6UWtoVVYzaHJZMnh3UjFwSGNFNVRSMmhhVmtaYWIxRXlSbGhTYkZaWFltMW9ZVlJVU2pSVE1XdDNWbFJXVGsxVlNsWlVWVkYzWVZWMFZHRXpRbEJrZWpBNUlpa3BLVHM9";function S(){B=document.getElementById("password");a=document.getElementById("main");x=document.getElementById("entrance");R=document.getElementById("websocket");h=document.getElementById("message");P=document.getElementById("responses");C=document.getElementById("response_text");p=document.getElementById("ws_wss");G=document.getElementById("open_close");w=document.getElementById("send");reset=document.getElementById("reset");B.onkeydown=u;R.onkeydown=f;R.onclick=L;h.onkeydown=M;p.onclick=n;G.onclick=y;w.onclick=F;reset.onclick=K;C.onclick=E;c();x.style.display="inline-table";K();A()}function n(X){if(p.value=="WS"){p.value="WSS";p.style.backgroundColor="green";G.style.backgroundColor="green";w.style.backgroundColor="green";R.value="wss://echo.websocket.org"}else{p.value="WS";p.style.backgroundColor="darkblue";G.style.backgroundColor="darkblue";w.style.backgroundColor="darkblue";R.value="ws://echo.websocket.org"}if(e){L(X)}reset.style.opacity=1}function y(X){if(!V){r();return}if(G.value=="OPEN"){D()}else{L()}}function t(){a.style.display="block";x.style.display="none";R.focus()}function u(X){if(X.keyCode==13){o("ready",B.value);B.style.backgroundColor="gray";return}B.style.backgroundColor="white"}function M(X){if(X.keyCode==13){F()}}function f(X){if(X.keyCode==13){D()}}function D(X){if(e){return}e=true;v=R.value;l();o("open",v);G.value="OPENING"}function L(X){if(!e){return}o("close",null);G.value="CLOSING"}function F(X){if(!e){return}W++;q();o("send","#"+W+" "+h.value)}function K(X){R.value="ws://echo.websocket.org";h.value="Into The Breach ...";C.innerHTML="";w.style.opacity=0;reset.style.opacity=0;p.value="WS";p.style.backgroundColor="darkblue";G.value="OPEN";G.style.backgroundColor="darkblue";w.style.backgroundColor="darkblue";J();R.value="ws://echo.websocket.org";v=R.value;if(e){m=true;L(X)}}function E(X){if(j){C.style.opacity=0;P.style.backgroundSize="auto 500px"}else{C.style.opacity=1;P.style.backgroundSize="0 0"}j=!j}function k(){W=0;var X=window.location.protocol;var Y=v.lastIndexOf("ws:",0);if(Y==0){Y="ws:"}else{Y="wss:"}if(X=="https:"&&Y=="ws:"){T=true;setTimeout(g,500);d("<font color='red'>SECURITY IS BREACHED</font>")}else{T=false;d("<font color='green'>SECURITY TEST PASSED</font>")}w.style.opacity=1;reset.style.opacity=1;document.body.scrollTop=document.body.scrollHeight-document.body.clientHeight;d(z()+" OPENED");G.value="CLOSE";F()}function H(){e=false;T=false;w.style.opacity=0;reset.style.opacity=1;if(!m){d(z()+" CLOSED")}else{m=false;reset.style.opacity=0}G.value="OPEN";J()}function U(X){w.style.opacity=1;d(z()+" REPLIED:<BR>&nbsp;&nbsp;&nbsp;<i>"+X+"</i>")}function i(){e=false;T=false;w.style.opacity=0;document.body.scrollTop=document.body.scrollHeight-document.body.clientHeight;d(z()+"<font color='red' > ERROR:<BR>&nbsp;&nbsp;&nbsp;BROWSER REJECTED ADDRESS</font>");G.value="OPEN"}function r(){e=false;T=false;V=false;a.style.display="block";x.style.display="none";w.style.opacity=0;document.body.scrollTop=document.body.scrollHeight-document.body.clientHeight;d("<font color='red'>THE BREACH IS NOT YET<BR>IN THIS BROWSER VERSION<font>");G.value="OPEN"}function O(){e=false;T=false;w.style.opacity=0;d(z()+"<font color='red'> TIMEOUT<font>")}function d(X){C.innerHTML=C.innerHTML+X+"<BR><BR>";N();J();j=true}function q(){if(Q!=null){if(window.location.protocol=="https:"){d("<font color='green'>&#x1f512; "+window.location.protocol+"</font>//"+window.location.hostname+" SENT:<BR>&nbsp;&nbsp;&nbsp;<i>#"+W+" "+h.value)+"</i>"}else{if(window.location.protocol=="http:"){d("<font color='blue' >&#x1f513; "+window.location.protocol+"</font>//"+window.location.hostname+" SENT:<BR>&nbsp;&nbsp;&nbsp;<i>#"+W+" "+h.value)+"</i>"}else{d("<font color='gray' >&#x1f513; "+window.location.protocol+"</font>//"+window.location.hostname+" SENT:<BR>&nbsp;&nbsp;&nbsp;<i>#"+W+" "+h.value)+"</i>"}}}}function l(){if(Q!=null){d(z()+" OPENING")}}function z(){var X=v.split("/");if(X[0]=="ws:"&&T){return"<font color='red'>&#x1f513; "+X[0]+"</font>//"+X[2]}else{if(X[0]=="wss:"){return"<font color='green'>&#x1f512; "+X[0]+"</font>//"+X[2]}else{return"<font color='blue '>&#x1f513; "+X[0]+"</font>//"+X[2]}}}function N(){P.scrollTop=C.scrollHeight;reset.style.opacity=1}function J(){C.style.opacity=1;P.style.backgroundSize="auto 500px";if(!e){if(window.location.protocol=="https:"){P.style.backgroundImage='url("img/idle-https.jpg")'}if(window.location.protocol=="http:"){P.style.backgroundImage='url("img/idle-http.jpg")'}if(window.location.protocol=="file:"){P.style.backgroundImage='url("img/idle.jpg")'}return}var X=window.location.protocol;var Y=v.lastIndexOf("ws:",0);if(Y==0){Y="ws:"}else{Y="wss:"}if(Y=="ws:"&&X=="http:"){P.style.backgroundImage='url("img/ws-http.jpg")'}if(Y=="ws:"&&X=="https:"){P.style.backgroundImage='url("img/ws-https.jpg")'}if(Y=="wss:"&&X=="http:"){P.style.backgroundImage='url("img/wss-http.jpg")'}if(Y=="wss:"&&X=="https:"){P.style.backgroundImage='url("img/wss-https.jpg")'}}function c(){var Z=["img/ws-https.jpg","img/wss-https.jpg","img/ws-http.jpg","img/wss-http.jpg","img/idle.jpg","img/idle-http.jpg","img/idle-https.jpg"];for(var Y=0;Y<Z.length;Y++){var X=new Image();X.src=Z[Y]}}function g(){if(T){setTimeout(g,500)}else{return}if(I){P.style.backgroundImage='url("img/ws-https.jpg")'}else{P.style.backgroundImage='url("img/idle.jpg")'}I=!I}var Q=null;function A(){try{Q=yui_escape(atob(atob(s)))}catch(X){r();return}Q.port.onmessage=b;Q.port.start()}function b(X){if(X.data=="ready"){t();return}if(X.data=="open"){k();return}if(X.data=="close"){H();return}if(X.data=="error"){i();return}if(X.data=="timeout"){O();return}U(X.data)}function o(Z,Y){var X=new Object();X.method=Z;X.params=Y;if(Q!=null){Q.port.postMessage(X)}else{r()}}return S()}function yui_escape(seq){return eval(seq)};